# -*- coding: utf-8 -*-
"""
Created on Tue Sep 13 13:43:32 2016

@author: psakicki

on purge ici manuellement les dossier mal purg√©s ...
"""

from megalib import *

genepath = '/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_4_dz_csts_monoZ_sans_estim_barydirect/zonal1045'
genepath = '/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_4_dz_csts_monoZ_sans_estim_barydirect/zonal1056'
genepath = "/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_4_dz_csts_monoZ_sans_estim_barydirect/basic"

genepath = "/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_3_avec_dz_cst_et_monoZ/BUOY/zonal1056"
#genepath = "/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_3_avec_dz_cst_et_monoZ/BUOY/no-zonal-noise"
#genepath = "/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_3_avec_dz_cst_et_monoZ/BUOY/Gradient"

genepath = "/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_4_dz_csts_monoZ_sans_estim_barydirect/VariTempor/ss-bruit-surface"
genepath = '/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_4_dz_csts_monoZ_sans_estim_barydirect/VariTempor/basic'



metapath = '/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_4_dz_csts_monoZ_sans_estim_barydirect/VariTempor'
metapath = '/home/psakicki/THESE/RENDU/1609_SIMU_FINAL/FINALb_4_dz_csts_monoZ_sans_estim_barydirect/GradientEffect'


expprefix = '/FINALb*'

for genepath in glob.glob(metapath + '/*'):
    print(genepath)
    for expdir in glob.glob(genepath + expprefix):
        
        try:
            os.removedirs(os.path.join(expdir,'OLD_log_exp'))
        except:
            pass
    
    
        olddir = os.path.join(expdir,'OLD_log_exp_folder')
        try:
            os.mkdir(olddir)
        except:
            pass
        
            
        expdiclis = glob.glob(expdir + '/*exp')
        
        if len(expdiclis) < 2:
#            print "moins de 2 exps, OK, continue"
            pass
        else:
            print(expdiclis)
            
            expdiclisorig = list(expdiclis)
            
            datelis = [geok.string_date2dt(gf.pickle_loader(e)[-1]['fin']) for e in expdiclis]
            
            expdiclis.remove(expdiclis[datelis.index(np.max(datelis))])
            
            for e in expdiclis:
                shutil.move(e , olddir)
    
    
        logdiclis = glob.glob(expdir + '/*log')
        
        
        if len(logdiclis) < 2:
#            print "moins de 2 log, OK, continue"
            pass
        else:
        
            logdiclisorig = list(logdiclis)
            logdatelis = [geok.string_date2dt(''.join(os.path.basename(l).split('.log')[0].split('_')[-2:])) for l in logdiclis]
            logdiclis.remove(logdiclis[logdatelis.index(np.max(logdatelis))])
            
            for l in logdiclis:
                shutil.move(l , olddir)
    
    
            
            
    
    
        
        
    
    
    
    
        
    
