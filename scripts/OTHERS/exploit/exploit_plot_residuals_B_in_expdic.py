#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Mar 21 18:10:54 2018

@author: psakicki
"""

from megalib import *

p = "/home/psakicki/GFZ_WORK/RENDU/1709_CANOPUS_Cloture/report_canopus/1505-1/Detection15mai_20170727_123039.exp"
p = "/home/psakicki/GFZ_WORK/PROJECTS_OTHERS/1709_GNSSA_InSitu_EXPs/1705_CANOPUS/O_files/Detection14mai_RC/Detection14mai_20170704_184817.exp"

pO = "/home/psakicki/GFZ_WORK/PROJECTS_OTHERS/1709_GNSSA_InSitu_EXPs/1705_CANOPUS/O_files/Detection14mai_RC/Detection14mai*O.dat"

exportdir = "/home/psakicki/GFZ_WORK/RENDU/1801_EGU_Vienne/Posters/GNSSA/plots/"

Olis = sorted(glob.glob(pO))

D = gf.pickle_loader(p)

lenstk = []
for po in Olis:
    lenstk.append(len(np.loadtxt(po)))
    


Y1 = D[ 1]["B"]
Y2 = D[-1]["B"]


plt.plot(Y1,".",label="res. at 1st iteration" )
plt.plot(Y2,".",label="res. at 4th iteration" )

for e in np.cumsum(lenstk):
    plt.axvline(e,c="red")


plt.ylabel("Two way travel time residuals (s)")
plt.xlabel("Nb of pings")

plt.legend()

fig = plt.gcf()

koef = 2
Len = (19.9/2.54) * koef
Hei = (9.6/2.54) * koef
fig.set_size_inches((Len,Hei))
fig.patch.set_alpha(0)

fig.tight_layout()

for ext in (".png",".pdf",".svg"):
    plt.savefig(exportdir + p.split("/")[-2] + "" + ext)
    

