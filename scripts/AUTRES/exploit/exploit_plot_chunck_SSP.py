#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Sep  5 23:23:39 2018

@author: psakicki
"""

from megalib import *

path = "/home/psakicki/aaa_FOURBI/GNSSA_SIMU_regroupement/GNSSA_SSP_tempo_update_for_SFGM-IPGP18_beta/*"

Lfoldr = glob.glob(path)

ecart2D_stk =  []
nbpings_stk =  []
name_stk    =  []
chunck_stk  =  []

for foldr in Lfoldr:
    Lexpdic = glob.glob(foldr + "/*exp")
    
    for expdic in Lexpdic:
        D     = gf.pickle_loader(expdic)
        
        Dlast = D[-1]
        
        ecart2D = Dlast['ecart 2D bary brut/vrai en distance']
        nbpings = Dlast["Nb pings"]
        name    = Dlast["nom"]
        chunck  = Dlast["epoch_SSP_chunk_parameter"]

        
        print(name , ecart2D)
        
        ecart2D_stk.append(ecart2D)
        nbpings_stk.append(nbpings)
        chunck_stk.append(chunck)
        
        name_stk.append(name)
        
        

fig , ax = plt.subplots()

ax.set_yscale('log')
#ax.set_xscale('log')

ax.set_xlabel("SSP temporal update")
ax.set_ylabel("Difference to the \n true barycenter (m, log. scale)")

#ax2 = ax.twiny()
#ax2.set_xscale('log')
#ax2.set_xlabel("duration of an (hours)")


for iii , (e2d , nbpi , nam , chunck) in enumerate(zip(ecart2D_stk , nbpings_stk , 
                                    name_stk , chunck_stk)):
    
    
    #print(iii,chunck,chunck_stk[iii])

    
    if "20100225" in nam:
        col = "b"

    else:
        col = "r"

        
    if "_R50_" in nam:
        sym = "o"
    else:
        sym = "s"
    
    ax.scatter(chunck , e2d , marker = sym , c = col , s = 100)
    #ax2.scatter((nbpi * 10)/3600, e2d , marker = sym , c = col , s = 100 ) 
    
    fig.set_size_inches(5*np.sqrt(2),3*np.sqrt(2))
    plt.tight_layout()
    
    gf.figure_saver(fig , "/home/psakicki/GFZ_WORK/RENDU/1801_EGU_Vienne/Posters/GNSSA/plots" , "ssp_update_beta" , ".pdf" )    
    gf.figure_saver(fig , "/home/psakicki/GFZ_WORK/RENDU/1801_EGU_Vienne/Posters/GNSSA/plots" , "ssp_update_beta" , ".png" )    
    